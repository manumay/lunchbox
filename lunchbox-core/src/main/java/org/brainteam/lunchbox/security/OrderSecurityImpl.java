package org.brainteam.lunchbox.security;import org.brainteam.lunchbox.domain.Order;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Component;@Componentpublic class OrderSecurityImpl implements OrderSecurity {		@Autowired	private Security security;	@Override	public void checkPermission(String key, Order order) {		boolean admin = getSecurity().isCurrentUserAdmin();		if (admin) {			return;		}				boolean offerLocked = order.getItem().getOffer().isLocked();		if (offerLocked) {			throw new SecurityException("offer of order is locked");		}				boolean isOwner = getSecurity().getCurrentUser().equals(order.getOrderer());		if (!isOwner) {			throw new SecurityException("user does not own order");		}	}		protected Security getSecurity() {		return security;	}	}